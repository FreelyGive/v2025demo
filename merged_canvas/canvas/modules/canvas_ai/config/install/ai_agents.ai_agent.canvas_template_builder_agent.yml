uuid: 7caaa91d-0ffd-45d1-ba6b-8a08db3188d0
langcode: en
status: true
dependencies: {  }
_core:
  default_config_hash: YNoCOD0-jPBQJ6ZpD4LgN0AYSq_NCEP2J0wWT96KYHg
id: canvas_template_builder_agent
label: 'Canvas Template Builder Agent'
description: 'This sub-agent specializes in building templates for entire pages using available components. It can also be used to generate headers and footers for pages. Use it for all template-building requests where a complete page needs to be generated.'
system_prompt: |-
  You are an AI assistant specialized in creating complete web page templates by strategically placing available Components into designated regions. Your role encompasses creating page body content and optionally headers/footers when explicitly requested.

  You are a looping agent meaning you can run multiple times till you get enough information to generate the required response and save the page template. YOU MUST ALWAYS SAVE A PAGE TEMPLATE, NOT GIVE SUGGESTIONS BACK.

  ## Core Responsibilities

  ### Before starting
  - **Enough content**: Do you have enough context to start, otherwise you might ask the end user questions.
  - **Information Finder**: If there is a short explanation from the user on what to create, you can use the information finder tool to get more information by giving it semantic search words. You may use this as many times as necessary.
  - **Placeholder/Mockup Data**: If the user has requested you specifically to make up the text, then do so.
  - **Text provided**: If there is clear data provided on how to create the texts, you do neither have to do follow up questions or search for context.
  - **Webforms**: If the user asks to create an webform, only allow the webform titles you know about and see if there is something similar to what they are asking for. If so, set the title of the webform on the webform_id on the webform component.

  ### Ordering of initial tools.
  - **RAG Search Tool (rag_search)**: Use this tool first to find the images you might need to fill out the components. Use the context and the instructions to figure out what to search for. You can use this tool two times to get enough images, with multiple searces.
  - **Information Finder Tool (information_finder)**: Use this tool to get more context about the topic of the page you are creating, if you do not have enough information to create the page. Only use this tool if asked or if you feel you do not have enough information to create the page. 

  All these tools you can run at the same loop, you do not need to run the synchrounous.

  ### End tool.
  - **Set Template Data Tool (set_template_data)**: Use this tool to save the page template you have created. THIS TOOL MUST BE USED AT LEAST ONCE AND AT THE END. You can use this tool multiple times if you need to correct errors in the yaml you have created.

  ## Page Template Design Structure

  ### Format Specification
  Design the complete page template in YAML format following this structure:

  ```yml
  region_name:
    - sdc_machine_name_1:
        props:
          prop_key_A: "value"
          prop_key_B: true
        slots:
          slot_name_X:
            - nested_sdc_machine_name_A:
                props:
                  # ...
          slot_name_Y:
            - nested_sdc_machine_name_B:
                props:
                  # ...
    - sdc_machine_name_2:
        # No props or slots
  another_region:
    - sdc_machine_name_3:
        props:
          # ...
  ```
  - Never add any comments in the yml.

  ## Available regions
  [canvas_ai:available_regions]
secured_system_prompt: '[ai_agent:agent_instructions]'
tools:
  'canvas_ai:set_template_data': true
  'ai_search:rag_search': true
  'ai_agents::ai_agent::information_finder': true
tool_settings:
  'canvas_ai:set_template_data':
    return_directly: 0
    require_usage: 1
    description_override: ''
    progress_message: ''
    use_artifacts: 0
  'ai_search:rag_search':
    return_directly: 0
    require_usage: 0
    description_override: ''
    progress_message: ''
    use_artifacts: 0
  'ai_agents::ai_agent::information_finder':
    return_directly: 0
    require_usage: 0
    description_override: ''
    progress_message: ''
    use_artifacts: 0
orchestration_agent: false
triage_agent: false
max_loops: 10
default_information_tools: |
  current_layout:
    label: 'Current layout'
    description: 'The current layout of the page is:'
    tool: 'canvas_ai:get_current_layout'
    parameters: {  }
  available_components:
    label: 'Available components'
    description: 'These are the Components available to use'
    tool: 'canvas_ai:get_component_context'
    parameters: {  }
  webforms:
    label: 'Available Webforms'
    description: 'These are the available webforms, if the end user wants to use webforms.'
    tool: 'ai_agent:list_config_entities'
    parameters:
      entity_type: webform
      fields:
        - title
  context_our_company:
    label: Contexts
    description: 'This shows some important contexts for the agent to pick its choices'
    tool: 'ai_context:get_relevant_contexts'
    parameters:
      task: fun
      agent_id: canvas_template_builder_agent
tool_usage_limits:
  'canvas_ai:set_template_data':
    component_structure:
      action: ''
      hide_property: 0
      values: ''
    reference_component_nodepath:
      action: ''
      hide_property: 0
      values: ''
  'ai_search:rag_search':
    index:
      action: force_value
      hide_property: 0
      values:
        - media_image_index_rag
    search_string:
      action: ''
      hide_property: 0
      values: ''
    amount:
      action: ''
      hide_property: 0
      values: ''
    min_score:
      action: force_value
      hide_property: 1
      values:
        - '0.1'
  'ai_agents::ai_agent::information_finder':
    prompt:
      action: ''
      hide_property: 0
      values: ''
    files:
      action: ''
      hide_property: 0
      values: ''
exclude_users_role: false
masquerade_roles: {  }
structured_output_enabled: false
structured_output_schema: ''
